<html>
<head>
<SCRIPT language="Javascript">

var DocRemote = 0;

function makeRemote(){

	if(DocRemote){
		if(DocRemote.closed){
			DocRemote = 0;
			makeRemote();
		}else{
			DocRemote.focus();
		}
	}else{
		DocRemote = window.open('../../search.cfm', 
					    'Search', 
					    'scrollbars,resizable,width=510,height=300');
    	}
}

</SCRIPT>
<script language="JavaScript">
<!--Hide JavaScript

   if (navigator.appName == "Netscape"){
      document.write('<LINK REL=STYLESHEET HREF="../../allaire_ns.css" TYPE="text/css">');
      }
   else{
      document.write('<LINK REL=STYLESHEET HREF="../../allaire_ie.css" TYPE="text/css">');
   }
//-->
</script>
<title>CFGRID</title>
</head>
<body>

<div class="navigation">
<table>
<tr valign="bottom">
<td width="90%" align="left" valign="bottom" nowrap><em>CFML Language Reference</em>
</td>
<td align="right" width="10%" valign="bottom" nowrap>
<a href="../2_ColdFusion_Tags/lr2_041.htm"><IMG alt="Previous" border="0" height="16" src="../../images/icons/back.gif" width="16"></a>
<a href="../2_ColdFusion_Tags/lr2.htm"><IMG alt="Up One Level" border="0" height="16" src="../../images/icons/uplevel.gif" width="16"></A>
<a href="../2_ColdFusion_Tags/lr2_043.htm"><IMG alt="Next" border="0" height="16" src="../../images/icons/next.gif" width="16"></a>
<a href="../../dochome.htm"><IMG alt="" border="0" height="16" src="../../images/icons/home.gif" width="16"></a>
<a href="javascript: makeRemote();"><IMG alt="Search" border="0" height="16" src="../../images/icons/search.gif" width="16"></a>
</td>
</tr>
<tr align="left" valign="top">
<td colspan="2">
<hr>
<b>Chapter 1	:&nbsp;&nbsp;ColdFusion Tags</b>
</td>
</tr>
</table>
</div>
<br>
<br>

<br>
<a name="1969319"></a>
 <H1>CFGRID</H1>



<p>Used inside <a href="../2_ColdFusion_Tags/lr2_040.htm#1968844">CFFORM</a>, CFGRID allows you to place a grid control in a ColdFusion form. A grid control is a table of data divided into rows and columns. CFGRID column data is specified with individual<a href="../2_ColdFusion_Tags/lr2_043.htm#1969546"> CFGRIDCOLUMN </a>tags. </p><p>See also <a href="../2_ColdFusion_Tags/lr2_044.htm#1969699">CFGRIDROW</a> and <a href="../2_ColdFusion_Tags/lr2_045.htm#1969726">CFGRIDUPDATE</a> tags.</p><a name="1969326"></a>
 
<H3>Syntax</H3>
<PRE>&lt;CFGRID NAME="name"
    HEIGHT="integer"
    WIDTH="integer"
    VSPACE="integer"
    HSPACE="integer"
    ALIGN="value"
    QUERY="query_name"
    INSERT="Yes/No"
    DELETE="Yes/No"
    SORT="Yes/No"
    FONT="column_font"
    FONTSIZE="size"
    ITALIC="Yes/No"
    BOLD="Yes/No"
    HREF="URL"
    HREFKEY="column_name"
    TARGET="URL_target"
    APPENDKEY="Yes/No"
    HIGHLIGHTHREF="Yes/No"
    ONVALIDATE="javascript_function"
    ONERROR="text"
    GRIDDATAALIGN="position"
    GRIDLINES="Yes/No"
    ROWHEIGHT="pixels"
    ROWHEADERS="Yes/No"
    ROWHEADERALIGN="position"
    ROWHEADERFONT="font_name"
    ROWHEADERFONTSIZE="size"
    ROWHEADERITALIC="Yes/No"
    ROWHEADERBOLD="Yes/No"
    ROWHEADERWIDTH="col_width"
    COLHEADERS="Yes/No"
    COLHEADERALIGN="position"
    COLHEADERFONT="font_name"
    COLHEADERFONTSIZE="size"
    COLHEADERITALIC="Yes/No"
    COLHEADERBOLD="Yes/No"
    BGCOLOR="color"
    SELECTCOLOR="color"
    SELECTMODE="mode"
    MAXROWS="number"
    NOTSUPPORTED="text"
    PICTUREBAR="Yes/No"
    INSERTBUTTON="text"
    DELETEBUTTON="text"
    SORTASCENDINGBUTTON="text"
    SORTDESCENDINGBUTTON="text"&gt;
&nbsp;
&lt;/CFGRID&gt;
</PRE><a name="1969328"></a>
<h4> NAME</h4>
<p>Required. A name for the grid element.</p><a name="1969330"></a>
<h4> HEIGHT</h4>
<p>Optional. Height value of the grid control in pixels.</p><a name="1969332"></a>
<h4> WIDTH</h4>
<p>Optional. Width value of the grid control in pixels. </p><a name="1969334"></a>
<h4> VSPACE</h4>
<p>Optional. Vertical margin spacing above and below the grid control in pixels.</p><a name="1969336"></a>
<h4> HSPACE</h4>
<p>Optional. Horizontal margin spacing to the left and right of the grid control in pixels.</p><a name="1969338"></a>
<h4> ALIGN</h4>
<p>Optional. Alignment value. Valid entries are: Top, Left, Bottom, Baseline, Texttop, Absbottom, Middle, Absmiddle, Right.</p><a name="1969340"></a>
<h4> QUERY</h4>
<p>Optional. The name of the query associated with the grid control. </p><a name="1969342"></a>
<h4> INSERT</h4>
<p>Optional. Yes or No. Yes allows end users to insert new row data into the grid. Default is No.</p><a name="1969344"></a>
<h4> DELETE</h4>
<p>Optional. Yes or No. Yes allows end users to delete row data in the grid. Default is No.</p><a name="1969346"></a>
<h4> SORT</h4>
<p>Optional. Yes or No. When Yes sort buttons are added to the grid control. When clicked the sort buttons perform a simple text sort on the selected column. Default is No.</p><a name="1969348"></a>
<h4> FONT</h4>
<p>Optional. Font name to use for all column data in the grid control. </p><a name="1969350"></a>
<h4> FONTSIZE</h4>
<p>Optional. Font size for text in the grid control, measured in points.</p><a name="1969352"></a>
<h4> </h4>
<a name="1969353"></a>
<h4> ITALIC</h4>
<p>Optional. Yes or No. Yes presents all grid control text in italic. Default is No.</p><a name="1969355"></a>
<h4> BOLD</h4>
<p>Optional. Yes or No. Yes presents all grid control text in boldface. Default is No.</p><a name="1969357"></a>
<h4> HREF</h4>
<p>Optional. URL to associate with the grid item or a query column for a grid that is populated from a query. If HREF is a query column, then the HREF value that is displayed is populated by the query. If HREF is not recognized as a query column, it is assumed that the HREF text is an actual HTML HREF.</p><a name="1969359"></a>
<h4> HREFKEY</h4>
<p>Optional. The name of a valid query column when the grid uses a query. The column specified becomes the Key no matter what the select mode is for the grid. </p><a name="1969361"></a>
<h4> TARGET</h4>
<p>Optional. Target attribute for HREF URL.</p><a name="1969363"></a>
<h4> APPENDKEY</h4>
<p>Optional. Yes or No. When used with HREF, Yes passes the CFGRIDKEY variable along with the value of the selected tree item in the URL to the application page specified in the CFFORM ACTION attribute. Default is Yes.</p><a name="1969365"></a>
<h4> HIGHLIGHTHREF</h4>
<p>Optional. Yes highlights links associated with a CFGRID with an HREF attribute value. No disables highlight. Default is Yes.</p><a name="1969367"></a>
<h4> ONVALIDATE</h4>
<p>Optional. The name of a valid JavaScript function used to validate user input. The form object, input object, and input object value are passed to the specified routine, which should return True if validation succeeds and False otherwise. </p><a name="1969369"></a>
<h4> ONERROR</h4>
<p>Optional. The name of a valid JavaScript function you want to execute in the event of a failed validation. </p><a name="1969371"></a>
<h4> GRIDDATAALIGN</h4>
<p>Optional. Enter Left, Right, or Center to position data in the grid within a column. Default is Left.</p><a name="1969373"></a>
<h4> GRIDLINES</h4>
<p>Optional. Yes or No. Yes enables rules (lines) in the grid control, No suppresses row and column rules. Default is Yes. </p><a name="1969375"></a>
<h4> ROWHEIGHT</h4>
<p>Optional. Enter a numeric value for the number of pixels to determine the minimum row height for the grid control. Used with CFGRIDCOLUMN TYPE="Image", you can use ROWHEIGHT to define enough room for graphics you want to display in the row.</p><a name="1969377"></a>
<h4> ROWHEADER</h4>
<p>Optional. Yes or No. Yes displays row labels in the grid control. Defaults to Yes. </p><a name="1969379"></a>
<h4> ROWHEADERALIGN</h4>
<p>Optional. Enter Left, Right, or Center to position data within a row header. Default is Left.</p><a name="1969381"></a>
<h4> ROWHEADERFONT</h4>
<p>Optional. Font to use for the row label. </p><a name="1969383"></a>
<h4> ROWHEADERFONTSIZE</h4>
<p>Optional. Size font for row label text in the grid control, measured in points.</p><a name="1969385"></a>
<h4> ROWHEADERITALIC</h4>
<p>Optional. Yes or No. Yes presents row label text in italic. Default is No.</p><a name="1969387"></a>
<h4> ROWHEADERBOLD</h4>
<p>Optional. Yes or No. Yes presents row label text in boldface. Default is No.</p><a name="1969389"></a>
<h4> ROWHEADERWIDTH</h4>
<p>Optional. The width, in pixels, of the row header column. </p><a name="1969391"></a>
<h4> COLHEADERS</h4>
<p>Optional. Yes or No. Yes displays column headers in the grid control. Defaults to Yes.</p><a name="1969393"></a>
<h4> COLHEADERALIGN</h4>
<p>Optional. Enter Left, Right, or Center to position data within a column header. Default is Left.</p><a name="1969395"></a>
<h4> COLHEADERFONT</h4>
<p>Optional. Font to use for the column header in the grid control. </p><a name="1969397"></a>
<h4> COLHEADERFONTSIZE</h4>
<p>Optional. Size font for column header text in the grid control, measured in points.</p><a name="1969399"></a>
<h4> COLHEADERITALIC</h4>
<p>Optional. Yes or No. Yes presents column header text in italic. Default is No.</p><a name="1969401"></a>
<h4> COLHEADERBOLD</h4>
<p>Optional. Yes or No. Yes presents column header text in boldface. Default is No.</p><a name="1969403"></a>
<h4> BGCOLOR</h4>
<p>Optional. Background color value for the grid control. Valid entries are: black, magenta, cyan, orange, darkgray, pink, gray, white, lightgray, yellow.</p><p>A hex value can be entered in the form: </p><pre>BGCOLOR="##<em>xxxxxx</em>"
</pre><p>where <em>x </em>is 0-9 or A-F. Use either two pound signs or no pound signs. </p><a name="1969408"></a>
<h4> SELECTCOLOR</h4>
<p>Optional. Background color for a selected item. See BGCOLOR for color options.</p><a name="1969410"></a>
<h4> SELECTMODE</h4>
<p>Optional. Selection mode for items in the grid control. Valid entries are:</p><ul>
<a name="1969412"> </a>
<li>Edit -- Users can edit grid data.

<a name="1969413"> </a>
</li>
<li>Single -- User selections are confined to the selected cell. 
<a name="1969414"> </a>
</li>
<li>Row -- User selections automatically extend to the row containing selected cell. 
<a name="1969415"> </a>
</li>
<li>Column -- User selections automatically extend to column containing selected cell. 
<a name="1969416"> </a>
</li>
<li>Browse -- User can only browse grid data. 
</li>
</ul>
<p>Default is Browse. </p><a name="1969418"></a>
<h4> MAXROWS</h4>
<p>Optional. Specifies the maximum number of rows you want to display in the grid.</p><a name="1969420"></a>
<h4> NOTSUPPORTED</h4>
<p>Optional. The text you want to display if the page containing a Java applet-based CFFORM control is opened by a browser that does not support Java or has Java support disabled. For example:</p><pre>NOTSUPPORTED="&lt;B&gt; Browser must support Java
to view ColdFusion Java Applets&lt;/B&gt;"
</pre><p>By default, if no message is specified, the following message appears:</p><pre>&lt;B&gt;Browser must support Java to &lt;BR&gt;
view ColdFusion Java Applets!&lt;/B&gt;
</pre><a name="1969427"></a>
<h4> PICTUREBAR</h4>
<p>Optional. Yes or No. When Yes, image buttons are used for the Insert, Delete, and Sort actions rather than text buttons. Default is No.</p><a name="1969429"></a>
<h4> INSERTBUTTON</h4>
<p>Optional. Text to use for the Insert action button. The default is Insert. </p><a name="1969431"></a>
<h4> DELETEBUTTON</h4>
<p>Optional. Text to use for the Delete action button. The default is Delete.</p><a name="1969433"></a>
<h4> SORTASCENDINGBUTTON</h4>
<p>Optional. The text to use for the Sort button. The default is "<code>A -&gt; Z</code>".</p><a name="1969435"></a>
<h4> SORTDESCENDINGBUTTON</h4>
<p>Optional. The text to use for the Sort button. The default is "<code>Z &lt;- A</code>".</p><a name="1969437"></a>
 
<H3>Usage</H3>
<p>You can populate a CFGRID with data from a <a href="../2_ColdFusion_Tags/lr2_073.htm#1019524">CFQUERY</a>. If you do not specify any <a href="../2_ColdFusion_Tags/lr2_043.htm#1969546">CFGRIDCOLUMN</a> entries, a default set of columns is generated. Each column in the query is included in the default column list. In addition, a default header for each column is created by replacing any hyphen (-) or underscore (_) characters in the table column name with spaces. The first character and any character after a space is changed to uppercase; all other characters are lowercase.</p><a name="1969445"></a>
 
<H2>Select mode and form variables</H2>
<p>Grid data is submitted in a CFFORM as form variables, depending on the value of the SELECTMODE attribute as follows:</p><ul>
<a name="1969447"> </a>
<li>When SELECTMODE="Single", grid data is returned as <em>grid_name</em>.<em>selectedname</em> and the value of the selected cell.

<a name="1969448"> </a>
</li>
<li>When SELECTMODE="Column", grid data is returned as a comma-separated list of all the values for the selected column.
<a name="1969449"> </a>
</li>
<li>When SELECTMODE="Row", grid data is returned as <em>grid_name.colum1_name</em> and <em>grid_name.column2_name</em> and their respective values for the selected row.
<a name="1969450"> </a>
</li>
<li>When SELECTMODE="Browse", no selection data is returned.
</li>
</ul>
<a name="1969451"></a>
 
<H2>Using SELECTMODE="Edit"</H2>
<p>When SELECTMODE=&quot;Edit ", one-dimensional arrays are used to store data about changes to the grid cells. For example, a one-dimensional array is used to store the type of edits made to grid cells:</p><pre>gridname.RowStatus.Action [ value ]
</pre><p>Where <em>gridname</em> is the name of the CFGRID and <em>action</em> is U, I, or D for Update, Insert, and Delete, respectively. </p><p>ColdFusion also maintains both the value of the edited cell and the original value in one-dimensional arrays. You can reference this data in ColdFusion expressions as follows:</p><pre>gridname.colname[ value ]
gridname.original.colname[ value ]
</pre><p>Where <em>gridname</em> is the name of the CFGRID, <em>colname</em> is the name of the column, and value is the index position containing the grid data. </p><a name="1969459"></a>
 
<H2>Using the HREF attribute</H2>
<p>When specifying a URL with grid items using the HREF attribute, the value of the SELECTMODE attribute determines whether the appended key value is limited to a single grid item or whether it extends to a grid column or row. When a user clicks on a linked grid item, a CFGRIDKEY variable is appended to the URL in the following form:</p><pre>http://myserver.com?CFGRIDKEY=selection
</pre><p>If the APPENDKEY attribute is set to No, then no grid values are appended to the URL. </p><p>The value of <em>selection</em> is determined by the value of the SELECTMODE attribute:</p><ul>
<a name="1969464"> </a>
<li>When SELECTMODE="Single", <em>selection </em>is the value of the column clicked.

<a name="1969465"> </a>
</li>
<li>When SELECTMODE="Row", <em>selection</em> is a comma-separated list of column values in the clicked row, beginning with the value of the first cell in the selected row.
</li>
</ul>
<p>When SELECTMODE="Column", selection is a comma-separated list of row values in the clicked column, beginning with the value of the first cell in the selected column.</p><div>
<table>
<tr valign="top">
<td width="30"><strong>Note	</strong></td>
<td>CFGRID incorporates a Java applet, so browsers must be Java-enabled for 
CFGRID to work properly.
</td>
</tr>
</table>
</div>
<br><a name="2037441"></a>
 
<H3>Example</H3>
<FORM ACTION="../../tagframe.cfm" TARGET="runcftag">
<INPUT TYPE="Hidden" NAME="tagname" VALUE="cfgrid
">
<INPUT TYPE="Submit" VALUE="Example">
</FORM><pre>&lt;!--- This example shows the CFGRID, CFGRIDCOLUMN, CFGRIDROW,
and CFGRIDUPDATE tags in action ---&gt;

&lt;!--- use a query to show the useful qualities of CFGRID ---&gt;

&lt;!--- If the gridEntered form field has been tripped,
perform the gridupdate on the table specified in the database.
Using the default value keyonly=yes allows us to change only
the information that differs from the previous grid ---&gt;
&lt;CFIF IsDefined("form.gridEntered") is True&gt;
&lt;CFGRIDUPDATE GRID="FirstGrid" DATASOURCE="cfsnippets" 
TABLENAME="CourseList"  KEYONLY="Yes"&gt;
&lt;/CFIF&gt;

&lt;!--- query the database to fill up the grid ---&gt;
&lt;CFQUERY NAME="GetCourses" DATASOURCE="cfsnippets"&gt;
SELECT Course_ID, Dept_ID, CorNumber,
         CorName, CorLevel, CorDesc
FROM   CourseList
ORDER by Dept_ID ASC, CorNumber ASC
&lt;/CFQUERY&gt;

&lt;HTML&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;
CFGRID Example
&lt;/TITLE&gt;
&lt;/HEAD&gt;

&lt;BODY&gt;
&lt;H3&gt;CFGRID Example&lt;/H3&gt;

&lt;I&gt;Try adding a course to the database, and then deleting it.&lt;/I&gt;
&lt;!--- call the CFFORM to allow us to use CFGRID controls ---&gt;
&lt;CFFORM ACTION="cfgrid.cfm" METHOD="POST" ENABLECAB="Yes"&gt;

&lt;!--- We include Course_ID in the CFGRID, but do not allow
for its selection or display ---&gt;
&lt;!--- CFGRIDCOLUMN tags are used to change the parameters
involved in displaying each data field in the table---&gt;

&lt;CFGRID NAME="FirstGrid" WIDTH="450" 
    QUERY="GetCourses" INSERT="Yes"
    DELETE="Yes" SORT="Yes" 
    FONT="Tahoma" BOLD="No" ITALIC="No"
    APPENDKEY="No" HIGHLIGHTHREF="No" 
    GRIDDATAALIGN="LEFT" GRIDLINES="Yes"
    ROWHEADERS="Yes" ROWHEADERALIGN="LEFT" 
    ROWHEADERITALIC="No" ROWHEADERBOLD="No" 
    COLHEADERS="Yes" COLHEADERALIGN="LEFT"
    COLHEADERITALIC="No" COLHEADERBOLD="No" 
    SELECTCOLOR="Red" SELECTMODE="EDIT" 
    PICTUREBAR="No" INSERTBUTTON="To insert"
    DELETEBUTTON="To delete" SORTASCENDINGBUTTON="Sort ASC"
    SORTDESCENDINGBUTTON="Sort DESC"&gt;
    &lt;CFGRIDCOLUMN NAME="Course_ID" DATAALIGN="LEFT" 
        BOLD="No" ITALIC="No"
        SELECT="No" DISPLAY="No" 
        HEADERBOLD="No" HEADERITALIC="No"&gt;
    &lt;CFGRIDCOLUMN NAME="Dept_ID" HEADER="Department"
        HEADERALIGN="LEFT" DATAALIGN="LEFT" 
        BOLD="Yes" ITALIC="No"
        SELECT="Yes" DISPLAY="Yes" 
        HEADERBOLD="No" HEADERITALIC="Yes"&gt;
    &lt;CFGRIDCOLUMN NAME="CorNumber" HEADER="Course ##"
        HEADERALIGN="LEFT" DATAALIGN="LEFT" 
        BOLD="No" ITALIC="No"
        SELECT="Yes" DISPLAY="Yes" 
        HEADERBOLD="No" HEADERITALIC="No"&gt;
    &lt;CFGRIDCOLUMN NAME="CorName" HEADER="Name" 
        HEADERALIGN="LEFT" DATAALIGN="LEFT" 
        FONT="Times" BOLD="No" 
        ITALIC="No" SELECT="Yes"
        DISPLAY="Yes" HEADERBOLD="No" 
        HEADERITALIC="No"&gt;
    &lt;CFGRIDCOLUMN NAME="CorLevel" HEADER="Level" 
        HEADERALIGN="LEFT" DATAALIGN="LEFT" 
        BOLD="No" ITALIC="No" 
        SELECT="Yes" DISPLAY="Yes"
        HEADERBOLD="No" HEADERITALIC="No"&gt;
    &lt;CFGRIDCOLUMN NAME="CorDesc" HEADER="Description"
        HEADERALIGN="LEFT" DATAALIGN="LEFT" 
        BOLD="No" ITALIC="No"
        SELECT="Yes" DISPLAY="Yes" 
        HEADERBOLD="No" HEADERITALIC="No"&gt;

&lt;/CFGRID&gt;

...
</pre><FORM ACTION="../../tagframe.cfm" TARGET="runcftag">
<INPUT TYPE="Hidden" NAME="tagname" VALUE="cfgrid
">
<INPUT TYPE="Submit" VALUE="Example">
</FORM>
<br>

<div class="navigation">
<table>
<tr valign="bottom">
<td class="copy" width="90%" align="left" valign="bottom" nowrap>
Copyright &#169; 1999, Allaire Corporation. All rights reserved.
</td>
<td align="right" width="10%" valign="bottom" nowrap>
<a href="../2_ColdFusion_Tags/lr2_041.htm"><IMG alt="Previous" border="0" height="16" src="../../images/icons/back.gif" width="16"></a>
<a href="../2_ColdFusion_Tags/lr2.htm"><IMG alt="Up" border="0" height="16" src="../../images/icons/uplevel.gif" width="16"></A>
<a href="../2_ColdFusion_Tags/lr2_043.htm"><IMG alt="Next" border="0" height="16" src="../../images/icons/next.gif" width="16"></a>
<a href="../../dochome.htm"><IMG alt="Home" border="0" height="16" src="../../images/icons/home.gif" width="16"></a>
<a href="javascript: makeRemote();"><IMG alt="Search" border="0" height="16" src="../../images/icons/search.gif" width="16"></a>
</td>
</tr>
</table>
</div>
<!-- Last updated: 10/29/99 10:39:45 -->
</body>
</html>