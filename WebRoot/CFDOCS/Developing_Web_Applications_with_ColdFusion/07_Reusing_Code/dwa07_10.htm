<html>
<head>
<SCRIPT language="Javascript">

var DocRemote = 0;

function makeRemote(){

	if(DocRemote){
		if(DocRemote.closed){
			DocRemote = 0;
			makeRemote();
		}else{
			DocRemote.focus();
		}
	}else{
		DocRemote = window.open('../../search.cfm', 
					    'Search', 
					    'scrollbars,resizable,width=510,height=300');
    	}
}

</SCRIPT>
<script language="JavaScript">
<!--Hide JavaScript

   if (navigator.appName == "Netscape"){
      document.write('<LINK REL=STYLESHEET HREF="../../allaire_ns.css" TYPE="text/css">');
      }
   else{
      document.write('<LINK REL=STYLESHEET HREF="../../allaire_ie.css" TYPE="text/css">');
   }
//-->
</script>
<title>Executing Custom Tags</title>
</head>
<body>

<div class="navigation">
<table>
<tr valign="bottom">
<td width="90%" align="left" valign="bottom" nowrap><em>Developing Web Applications with ColdFusion</em>
</td>
<td align="right" width="10%" valign="bottom" nowrap>
<a href="../07_Reusing_Code/dwa07_09.htm"><IMG alt="Previous" border="0" height="16" src="../../images/icons/back.gif" width="16"></a>
<a href="../07_Reusing_Code/dwa07.htm"><IMG alt="Up One Level" border="0" height="16" src="../../images/icons/uplevel.gif" width="16"></A>
<a href="../07_Reusing_Code/dwa07_11.htm"><IMG alt="Next" border="0" height="16" src="../../images/icons/next.gif" width="16"></a>
<a href="../../dochome.htm"><IMG alt="" border="0" height="16" src="../../images/icons/home.gif" width="16"></a>
<a href="javascript: makeRemote();"><IMG alt="Search" border="0" height="16" src="../../images/icons/search.gif" width="16"></a>
</td>
</tr>
<tr align="left" valign="top">
<td colspan="2">
<hr>
<b>Chapter 7	:&nbsp;&nbsp;Reusing Code</b>
</td>
</tr>
</table>
</div>
<br>
<br>

<br>
<a name="1030008"></a>
 <H1>Executing Custom Tags</H1>



<a name="1030009"></a>
 
<H2>Tag instance data</H2>
<p>During the execution of a custom tag template, ColdFusion keeps some data related to the tag instance. The ThisTag scope is used to preserve this data with a unique identifier. The behavior is similar to the File scope.</p><p>The following variables are generated by the ThisTag scope:</p><ul>
<li>ExecutionMode -- valid values are "start" and "end."

</li>
<li>HasEndTag -- used for code validation, it distinguishes between custom tags that have and don't have end tags for ExecutionMode=start. The name of the Boolean value is ThisTag.HasEndTag. 
</li>
<li>GeneratedContent -- can be processed as a variable.
</li>
<li>AssocAttribs -- holds the attributes of all nested tags if CFASSOCIATE was used them.
</li>
</ul>
<a name="1030016"></a>
 
<H2>Pattern of execution</H2>
<p>The same CFML template is executed for both the start and end tag of a custom tag.</p><a name="1030018"></a>
 
<H2>Modes of execution</H2>
<p>ColdFusion invokes a custom tag template in either of two modes:</p><ul>
<li>Start tag execution

</li>
<li>End tag execution
</li>
</ul>
<p>If an end tag is not explicitly provided and shorthand empty element syntax (&lt;TagName .../&gt;) is not used, the custom tag template will be invoked only once in start tag mode. If a tag must have an end tag provided, use ThisTag.HasEndTag during start tag execution to validate this.</p><a name="1030023"></a>
 
<H2>Specifying execution modes</H2>
<p>A variable with the reserved name ThisTag.ExecutionMode will specify the mode of invocation of a custom tag template. The variable will have one of the following values:</p><ul>
<li>Start -- start tag execution

</li>
<li>End -- end tag execution
</li>
</ul>
<p>During the execution of the body of the custom tag, the value of the ExecutionMode variable is going to be <em>inactive</em>. In this framework, the template of a custom tag that wants to perform some processing in both modes may look something like the following:</p><pre>&lt;CFIF ThisTag.ExecutionMode is 'start'&gt;
    &lt;!--- Start tag processing ---&gt;
&lt;CFELSE&gt;
    &lt;!--- End tag processing ---&gt;
&lt;/CFIF&gt;
</pre><p>CFSWITCH can also be used:</p><pre>&lt;CFSWITCH expression=#ThisTag.ExecutionMode#&gt;
    &lt;CFCASE value= 'start'&gt;
        &lt;!--- Start tag processing ---&gt;
    &lt;/CFCASE&gt;
    &lt;CFCASE value='end'&gt;
        &lt;!--- End tag processing ---&gt;
    &lt;/CFCASE&gt;
&lt;/CFSWITCH&gt;
</pre><a name="1030032"></a>
 
<H2>Terminating tag execution</H2>
<p>CFEXIT terminates execution of a custom tag. CFEXIT's METHOD attribute specifies where execution continues. CFEXIT can specify that processing continues from the first child of the tag or continues immediately after the end tag marker.</p><p>The METHOD attribute can also be used to specify that the tag body should be executed again. This enables custom tags to act as high-level iterators, emulating CFLOOP behavior.</p><p>The following table summarizes CFEXIT behavior:<div> 
<table border="1" cellpadding="3" cellspacing="0">
<caption></caption>
<tr valign="top"><th colspan=3 rowspan=1>
<strong>CFEXIT Behavior in a Custom Tag&nbsp;</strong>
</th></tr>
<tr valign="top"><th align="left">
<strong>METHOD Attribute Value</strong>
</th><th align="left">
<strong>Location of CFExit Call</strong>
</th><th align="left">
<strong>Behavior</strong>
</th></tr>
<tr valign="top"><td valign="top">
ExitTag (default)
</td><td valign="top">
Base template
</td><td valign="top">
Acts like CFABORT
</td></tr>
<tr valign="top"><td valign="top">
&nbsp;
</td><td valign="top">
ExecutionMode=start
</td><td valign="top">
Continue after end tag
</td></tr>
<tr valign="top"><td valign="top">
&nbsp;
</td><td valign="top">
ExecutionMode=end
</td><td valign="top">
Continue after end tag
</td></tr>
<tr valign="top"><td valign="top">
ExitTemplate
</td><td valign="top">
Base template
</td><td valign="top">
Acts like CFABORT
</td></tr>
<tr valign="top"><td valign="top">
&nbsp;
</td><td valign="top">
ExecutionMode=start
</td><td valign="top">
Continue from first child in body
</td></tr>
<tr valign="top"><td valign="top">
&nbsp;
</td><td valign="top">
ExecutionMode=end
</td><td valign="top">
Continue after end tag
</td></tr>
<tr valign="top"><td valign="top">
Loop
</td><td valign="top">
Base template
</td><td valign="top">
Error
</td></tr>
<tr valign="top"><td valign="top">
&nbsp;
</td><td valign="top">
ExecutionMode=start
</td><td valign="top">
Error
</td></tr>
<tr valign="top"><td valign="top">
&nbsp;
</td><td valign="top">
ExecutionMode=end
</td><td valign="top">
Continue from first child in body
</td></tr>

</table>
</div>
</p><a name="1030106"></a>
 
<H2>Access to generated content</H2>
<p>Custom tags can access and modify the generated content of any of its instances using the ThisTag.GeneratedContent variable. In this context, the term <em>generated content</em> means the portion of the results that is generated by the body of a given tag. This includes all results generated by descendant tags, too. Any changes to the value of this variable will result in changes to the generated content.</p><p>ThisTag.GeneratedContent is always empty during the processing of a start tag. Any output generated during start tag processing is not considered part of the tag's generated content.</p><p>As an example, consider a tag that comments out the HTML generated by its descendants. Its implementation could look something like this: </p><pre>&lt;CFIF ThisTag.ExecutionMode is 'end'&gt;
&lt;CFSET ThisTag.GeneratedContent =
        '&lt;!--#ThisTag.GeneratedContent#--&gt;'&gt;
&lt;/CFIF&gt;
</pre>
<br>

<div class="navigation">
<table>
<tr valign="bottom">
<td class="copy" width="90%" align="left" valign="bottom" nowrap>
Copyright &#169; 1999, Allaire Corporation. All rights reserved.
</td>
<td align="right" width="10%" valign="bottom" nowrap>
<a href="../07_Reusing_Code/dwa07_09.htm"><IMG alt="Previous" border="0" height="16" src="../../images/icons/back.gif" width="16"></a>
<a href="../07_Reusing_Code/dwa07.htm"><IMG alt="Up" border="0" height="16" src="../../images/icons/uplevel.gif" width="16"></A>
<a href="../07_Reusing_Code/dwa07_11.htm"><IMG alt="Next" border="0" height="16" src="../../images/icons/next.gif" width="16"></a>
<a href="../../dochome.htm"><IMG alt="Home" border="0" height="16" src="../../images/icons/home.gif" width="16"></a>
<a href="javascript: makeRemote();"><IMG alt="Search" border="0" height="16" src="../../images/icons/search.gif" width="16"></a>
</td>
</tr>
</table>
</div>
<!-- Last updated: 10/27/99 18:19:46 -->
</body>
</html>