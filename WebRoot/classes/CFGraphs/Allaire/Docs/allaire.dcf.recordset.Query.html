<!--NewPage-->
<html>
<head>
<!-- Generated by javadoc on Thu Apr 25 11:16:10  1996 -->
<a name="_top_"></a>
<title>
  Class allaire.dcf.recordset.Query
</title>
</head>
<body>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-allaire.dcf.recordset.html">This Package</a>  <a href="allaire.dcf.recordset.AppletParamRecordset.html#_top_">Previous</a>  <a href="allaire.dcf.recordset.Recordset.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
<hr>
<h1>
  Class allaire.dcf.recordset.Query
</h1>
<pre>
<a href="java.lang.Object.html#_top_">java.lang.Object</a>
   |
   +----allaire.dcf.recordset.Query
</pre>
<hr>
<dl>
  <dt> public class <b>Query</b>
  <dt> extends <a href="java.lang.Object.html#_top_">Object</a>
</dl>
A class that executes Cold Fusion templates on remote servers.
The templates typically contain one or more SQL queries
which are returned in text format and then parsed into Recordset
objects for use by the client object.
<dl>
    <dt> <b>See Also:</b>
    <dd> <a href="allaire.dcf.recordset.Recordset.html#_top_">Recordset</a>
</dl>
<hr>
<a name="index"></a>
<h2>
  <img src="images/constructor-index.gif" width=275 height=38 alt="Constructor Index">
</h2>
<dl>
  <dt> <img src="images/yellow-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#Query(java.lang.String)"><b>Query</b></a>(String)
  <dd> Create a new query object which is linked to a template
on a remote server.
</dl>
<h2>
  <img src="images/method-index.gif" width=207 height=38 alt="Method Index">
</h2>
<dl>
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#addParam(java.lang.String, java.lang.String)"><b>addParam</b></a>(String, String)
  <dd> Add a named parameter to the query (the parameter will be
URL encoded and appended to the URL submitted to the
remote server).
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#execute()"><b>execute</b></a>()
  <dd> Execute the template on the remote server using the specified
parameters.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#getRecordset()"><b>getRecordset</b></a>()
  <dd> Gets the recordset fetched by the query from the remote
template.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#getRecordset(java.lang.String)"><b>getRecordset</b></a>(String)
  <dd> Gets a named recordset fetched by the query from
the remote template.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#getRecordsets()"><b>getRecordsets</b></a>()
  <dd> Gets all of the Recordsets fetched by the query from
the remote server.
  <dt> <img src="images/red-ball-small.gif" width=6 height=6 alt=" o ">
	<a href="#resetParams()"><b>resetParams</b></a>()
  <dd> Reset the parameter list to empty.
</dl>
<a name="constructors"></a>
<h2>
  <img src="images/constructors.gif" width=231 height=38 alt="Constructors">
</h2>
<a name="Query"></a>
<a name="Query(java.lang.String)"><img src="images/yellow-ball.gif" width=12 height=12 alt=" o "></a>
<b>Query</b>
<pre>
  public Query(<a href="java.lang.String.html#_top_">String</a> strTemplateURL)
</pre>
<dl>
  <dd> Create a new query object which is linked to a template
on a remote server. Constructing a Query object does not
cause the Query to be executed (this is accomplished using
the execute() method). <P>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> strTemplateURL - The fully qualified URL of the
template be used by the Query.
  </dl>
</dl>
<a name="methods"></a>
<h2>
  <img src="images/methods.gif" width=151 height=38 alt="Methods">
</h2>
<a name="addParam(java.lang.String, java.lang.String)"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="addParam"><b>addParam</b></a>
<pre>
  public void addParam(<a href="java.lang.String.html#_top_">String</a> strName,
                       <a href="java.lang.String.html#_top_">String</a> strValue)
</pre>
<dl>
  <dd> Add a named parameter to the query (the parameter will be
URL encoded and appended to the URL submitted to the
remote server). <P>
  <dl>
    <dt> <b>Parameters:</b>
    <dd> strName - The name of the parameter.
    <dd> strValue - The value of the parameter.
  </dl>
</dl>
<a name="resetParams()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="resetParams"><b>resetParams</b></a>
<pre>
  public void resetParams()
</pre>
<dl>
  <dd> Reset the parameter list to empty. This erases all parameters
previously added using the addParam() method.
</dl>
<a name="execute()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="execute"><b>execute</b></a>
<pre>
  public void execute() throws <a href="java.lang.Exception.html#_top_">Exception</a>
</pre>
<dl>
  <dd> Execute the template on the remote server using the specified
parameters. All Recordsets returned by the template will be
parsed and made available using the getRecordset member functions.
  <dl>
    <dt> <b>Throws:</b> <a href="java.lang.Exception.html#_top_">Exception</a>
    <dd> Throws an exception if one of several types
of error occurs including:
<OL>
 <LI> A malformed URL was used to construct the Query.
 <LI> A network I/O error occurs.
 <LI> A database or syntax error occurs in the template.
 <LI> The Recordset syntax in the template is invalid.
</OL>
  </dl>
</dl>
<a name="getRecordset()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="getRecordset"><b>getRecordset</b></a>
<pre>
  public <a href="allaire.dcf.recordset.Recordset.html#_top_">Recordset</a> getRecordset() throws <a href="java.lang.Exception.html#_top_">Exception</a>
</pre>
<dl>
  <dd> Gets the recordset fetched by the query from the remote
template. Use this version of getRecordset when the template
returns a single (typically unnamed) Recordset.
  <dl>
    <dt> <b>Returns:</b>
    <dd> The Recordset fetched by the query.
    <dt> <b>Throws:</b> <a href="java.lang.Exception.html#_top_">Exception</a>
    <dd> Throws an exception if no Recordset
was returned by the query.
  </dl>
</dl>
<a name="getRecordset(java.lang.String)"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="getRecordset"><b>getRecordset</b></a>
<pre>
  public <a href="allaire.dcf.recordset.Recordset.html#_top_">Recordset</a> getRecordset(<a href="java.lang.String.html#_top_">String</a> strName) throws <a href="java.lang.Exception.html#_top_">Exception</a>
</pre>
<dl>
  <dd> Gets a named recordset fetched by the query from
the remote template. Use this version of getRecordset when
the template returns multiple, named Recordsets. Note
that Recordset names are case-sensitive.
  <dl>
    <dt> <b>Parameters:</b>
    <dd> strName - The name of the Recordset to retreive.
    <dt> <b>Returns:</b>
    <dd> The Recordset with the specified name.
    <dt> <b>Throws:</b> <a href="java.lang.Exception.html#_top_">Exception</a>
    <dd> Throws an exception if no Recordset
with the passed name was returned by the Query.
  </dl>
</dl>
<a name="getRecordsets()"><img src="images/red-ball.gif" width=12 height=12 alt=" o "></a>
<a name="getRecordsets"><b>getRecordsets</b></a>
<pre>
  public <a href="java.util.Dictionary.html#_top_">Dictionary</a> getRecordsets()
</pre>
<dl>
  <dd> Gets all of the Recordsets fetched by the query from
the remote server.
  <dl>
    <dt> <b>Returns:</b>
    <dd> A Dictionary (keyed by Recordset name) containing
all of the Recordsets returned by the Query.
  </dl>
</dl>
<hr>
<pre>
<a href="packages.html">All Packages</a>  <a href="tree.html">Class Hierarchy</a>  <a href="Package-allaire.dcf.recordset.html">This Package</a>  <a href="allaire.dcf.recordset.AppletParamRecordset.html#_top_">Previous</a>  <a href="allaire.dcf.recordset.Recordset.html#_top_">Next</a>  <a href="AllNames.html">Index</a></pre>
</body>
</html>
